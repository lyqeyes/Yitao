@{
    Layout = null;
}
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    @using YiTao.Modules.Bll.Models
    @model YiTao.Web.Areas.Watch.Models.Prezis
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <title>抽奖</title>
    @*<link type="text/css" href="/css/unify.css" rel="stylesheet" />
    <link type="text/css" href="/css/user-base.css" rel="stylesheet" />*@
    <script type="text/ecmascript" src="/js/index.js"></script>
    <link href="/css/common.css" rel="stylesheet" />
    <link type="text/css" href="~/style/unify.css" rel="stylesheet" />
    <link type="text/css" href="~/style/user-base.css" rel="stylesheet" />
    <script type="text/ecmascript" src="~/js/index.js"></script>
</head>

<body>
    <link href="/css/style.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" language="javascript" src="/js/jquery-1.9.0.min.js"></script>
    <script type="text/javascript" language="javascript" src="/js/jQueryRotate.2.2.js"></script>
    <script type="text/javascript" language="javascript" src="/js/jquery.easing.min.js"></script>
    <script type="text/javascript" language="javascript" src="/js/alert.js"></script>
    <script language="javascript" type="text/javascript">
        $(function () {
            var rotateFunc = function (angle, text) {  //awards:奖项，angle:奖项对应的角度
                $('#lotteryBtn').stopRotate();
                $("#lotteryBtn").rotate({
                    angle: 0,
                    duration: 5000,
                    animateTo: angle + 1440, //angle是图片上各奖项对应的角度，1440是我要让指针旋转4圈。所以最后的结束的角度就是这样子^^
                    callback: function () {
                        alert(text)
                    }
                });
            };

            $("#btnstart").rotate({
                bind: {
                    click: function () {
                        $.ajax({
                            cache: true,
                            type: "POST",
                            url: "/watch/duihuan/choujiangresult",
                            async: false,
                            error: function (request) {
                                alert("未知错误，请刷新整个页面后重新抽取。");
                            },
                            success: function (data) {
                                var value = $("#jifenNow").html();
                                if (value > 0) {
                                    valueNew = parseInt(value) - 1;
                                }
                                $("#jifenNow").html(valueNew);
                                if (data == -1) {
                                    rotateFunc(0, '您都没有积分了....不能抽奖')
                                }
                                if (data == 1) {
                                    rotateFunc(202.5, '恭喜您抽中的一等奖')
                                }
                                if (data == 2) {
                                    rotateFunc(112.5, '恭喜您抽中的二等奖')
                                }
                                if (data == 3) {
                                    rotateFunc(337.5, '恭喜您抽中的三等奖')
                                }
                                if (data == 0) {
                                    var angle = [22.5, 67.5, 157.5, 247.5, 292.5];
                                    var msg = ['不要灰心', '祝你好运', '再接再厉', '运气先攒着', '要加油哦'];
                                    var rd = Math.floor(Math.random() * angle.length);
                                    angle = angle[rd];
                                    msg = msg[rd];
                                    rotateFunc(angle, msg);
                                }
                                //if (data == -1) {
                                //    rotateFunc(0, '您今天已经抽过奖了，请明天再来！');
                                //}
                                //if (data == -2) {
                                //    rotateFunc(0, '登录信息失效，请重新登录后再次抽奖！');
                                //}
                            }
                        });
                    }
                }
            });
        });
    </script>
    @*<div class="my_head">
        <img src="/img/buttons/09.png" class="header_left_pic" onclick="history.go(-1)" />
        <span>积分抽奖</span>
    </div>*@
    <div id="warp">
        <div id="top">
            <div class="top_title">积分抽奖</div>
            <a class="top_return" type="button" href="javascript:history.go(-1)" />
            <a class="top_search" href="/Watch/Yitao/Search"><img src="/img/search_02.png" /></a>
        </div>
    </div>
        <div class="main">
            @{
            Account theAcc = ViewData["account"] as Account;
            if (theAcc.JiFen < 1)
            {
        <div style="width:100%;">
            <div style="height:80px;border-bottom:1px solid #808080; color:red;padding:2em 1em; font-size:20px;">
                <h2>积分不够 不能抽奖</h2>
                <p style="margin-top:1em;">赶快赚取积分吧~</p>
            </div>
        </div>
            }
            else
            {
        <div class="out">
            <div class="out1"><img id="lotteryBtn" src="/img/ly-plate.jpg" /></div>
        </div>
        <div class="in">
            <div class="in1"><img id="btnstart" src="/img/rotate-static.png" /></div>
        </div>
            }
            }
        </div>
        <div class="award" style="text-align:center;margin-top:7em;">
            <p>当前积分:<b style="color:red;" id="jifenNow">@theAcc.JiFen </b>每次消耗<b style="color:red;"> 1 </b>积分</p>
            @*<p>一等奖: <span class="prezi">@Model.firstPrize</span><span></span></p>
                <p>二等奖: <span class="prezi">@Model.secondPrize</span></p>
                <p>三等奖: <span class="prezi">@Model.thirdPrize</span></p>*@
        </div>
        <div class="award" style="margin:0 auto;margin-top:1em; text-align:center;">
            <ul>
                <li class="link">
                    <a class="linktext"> 一等奖 </a>
                    <a href="#"><img class="item" src="@Model.firstImg" /></a>
                    <a class="linktext prezi"> @Model.firstPrize </a>
                </li>
                <li class="link">
                    <a class="linktext"> 二等奖 </a>
                    <a href="#"><img class="item" src="@Model.secondImg" /></a>
                    <a class="linktext prezi"> @Model.secondPrize </a>
                </li>
                <li class="link">
                    <a class="linktext"> 三等奖 </a>
                    <a href="#"><img class="item" src="@Model.thirdImg" /></a>
                    <a class="linktext prezi"> @Model.thirdPrize </a>
                </li>
                @*<li style="clear:both"></li>*@
            </ul>
        </div>
        <style>
            .item {
                width: 22%;
            }

            a {
                color: #000000;
            }

                a:visited {
                    color: #000000;
                }
        </style>
        <style>
            .prezi {
                color: #0026ff;
            }

            .my_head {
                text-align: center;
                position: absolute;
                width: 100%;
                height: 50px;
                background-color: #fff;
                font-family: "微软雅黑,宋体";
                box-sizing: border-box;
                -moz-box-sizing: border-box;
                box-shadow: 2px 2px 5px #999;
                z-index: 2;
                top: 0px;
                left: 0px;
            }

                .my_head span {
                    font-family: "Microsoft YaHei UI";
                    color: #ea662e;
                    font-size: 28px;
                    cursor: pointer;
                    margin-left: -20px;
                }

                .my_head .header_left_pic {
                    float: left;
                }
        </style>
    </div></body>
</html>
